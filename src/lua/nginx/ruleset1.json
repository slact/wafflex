{
  "name": "ruleset1",
  "phases": {
    "request": [ "list1", [], []]
  },
  
  "limiters": {
    "rate-limit": {
      "interval": 60, //seconds
      "limit": 100,
      "burst": "burst-limit",
      "burst-expire": "1h"
    },
    "burst-limit": {
      "interval": "1h",
      "limit": 100000 // burst at 100K/hour
    }
  },
  
  "lists": {
    "list1": [
      "fweep",
      "fwoop",
      {
        "info": "This rule rate-limits by ip",
        "if": {"limit-break" : {
          "name": "rate-limit",
          "key": "$request_real_ip"
        }},
        "then": [
          {"#tag": "slowdown"},
          {"#reject": {"status": 403, "body": "Slow down!!!"}}
        ]
      }
    ]
  },
  "rules": {   //named rules
    "fweep": {
      "if": { "#tag-check": "foo"},
      "then": {"#tag":"yeah"}
    }, 
    "fwoop": { "always": { "#tag":"this is a tag yo" } },
    "rule1": { 
      "if-all": ["#true", {"any": ["#true", "#false"]}],
      "then": "accept",
      "else": "reject"
    }
  }
}
